#!/bin/sh
# Connect with TUW VPN.
# Disconnect with alias `vpnoff`.

printf "%s\n%s" "$(pass show tuw/tiss | head -n1)" "$(pass otp tuw/tiss)" | sudo openconnect \
    --useragent="AnyConnect OpenConnect" \
    --no-external-auth \
    --authgroup="1_TU_getunnelt" \
    --background \
    --passwd-on-stdin \
    --user "$(pass show tuw/mail | awk 'NR==2 {print $2}')" \
    vpn.tuwien.ac.at
